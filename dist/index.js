"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=r(e);function t(e,r){for(var n=0;n<r.length;n++){var t=r[n];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,a(t.key),t)}}function u(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var t,u,o,c,i=[],a=!0,l=!1;try{if(o=(n=n.call(e)).next,0===r){if(Object(n)!==n)return;a=!1}else for(;!(a=(t=o.call(n)).done)&&(i.push(t.value),i.length!==r);a=!0);}catch(e){l=!0,u=e}finally{try{if(!a&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw u}}return i}}(e,r)||c(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||c(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,r){if(e){if("string"==typeof e)return i(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,r):void 0}}function i(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}function a(e){var r=function(e,r){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var t=n.call(e,r||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==typeof r?r:String(r)}var l=new(function(){function e(){var r,n,t;!function(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),r=this,t=[],(n=a(n="observers"))in r?Object.defineProperty(r,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[n]=t}var r,n,u;return r=e,(n=[{key:"subscribe",value:function(e){this.observers.push(e)}},{key:"unsubscribe",value:function(e){var r=this.observers.indexOf(e);-1!==r&&this.observers.splice(r,1)}},{key:"emit",value:function(){this.observers.forEach((function(e){return e()}))}}])&&t(r.prototype,n),u&&t(r,u),Object.defineProperty(r,"prototype",{writable:!1}),e}()),f="__REDUX_DEVTOOLS_EXTENSION__",s=function(e){return"[useMemoReducer] ".concat(e)},v=function(e){return"development"===process.env.NODE_ENV&&""!==e&&"undefined"!=typeof window&&(r=window,f in r&&r[f]);var r},d=new Map([]),b=function(e){var r=u(e.split("/"),2);return[r[0],r[1]-1]},y=function(e,r){var n,t=u(b(e),2),c=t[0],i=t[1],a=null!==(n=d.get(c))&&void 0!==n?n:[],l=a[i];if(l)return l;var f=function(e,r){return e?e.connect({name:s(r),trace:!0,instanceId:s(r)}):null}(v(e),e);return f?(d.set(c,[].concat(o(a),[f])),f.init(r),f):(console.warn("[useReduxDevtools] Connection ".concat(e," was not created.")),null)},m=function(e){!function(e){var r,n=u(b(e),2),t=n[0],o=n[1],c=null!==(r=d.get(t))&&void 0!==r?r:[];if(c[o]){var i=c.filter((function(e,r){return r!==o}));0===i.length?d.delete(t):d.set(t,i)}else console.warn("[useMemoReducer] Connection ".concat(e," is not exists"))}(e);var r=v(e);r&&(r.disconnect(),l.emit())},p=function(r,n,t,o){var c=e.useRef(r(n,{type:"@@INIT"})),i=e.useMemo((function(){return o?y(t,c.current):null}),[t,o]);if(!i)return{devtoolsEnabled:function(){return!1}};var a=e.useRef(),f=e.useCallback((function(){var e;return null===(e=a.current)||void 0===e||e.call(a),null==i?void 0:i.subscribe((function(e){}))}),[i]),s=e.useCallback((function(){null==i||i.send({type:"@@RECONNECT"},c.current),a.current=f()}),[i,f]);e.useEffect((function(){return l.subscribe(s),function(){l.unsubscribe(s)}}),[s]),e.useEffect((function(){return a.current=f(),function(){var e;null===(e=a.current)||void 0===e||e.call(a),m(t)}}),[t,f]);var v=e.useCallback((function(e){c.current=r(c.current,e),null==i||i.send(e,c.current)}),[i,r]),p=e.useCallback((function(){return function(e){var r,n=u(b(e),2),t=n[0],o=n[1];return void 0!==(null===(r=d.get(t))||void 0===r?void 0:r[o])}(t)}),[t]);return e.useMemo((function(){return{devtoolsEnabled:p,dispatchToDevtools:v}}),[p,v])},h=function(r,n,t){var u=e.useRef(n),o=e.useMemo((function(){return function(e){var r;if(null==e||!e.devtoolsName)return"";var n=e.devtoolsName.toLowerCase(),t=null!==(r=d.get(n))&&void 0!==r?r:[],u=t.length>0?t.length+1:1;return"".concat(n,"/").concat(u)}(t)}),[]);return p(r,u.current,o,function(e){return""!==e&&v(e)}(o))},w=function(r,n,t){var o=h(r,n,t),c=e.useRef(o);c.current=o;var i=e.useRef(r),a=e.useRef(n),l=function(){return a.current},f=e.useCallback((function(e){if(function(e){return"function"==typeof e}(e))return e(f,l);var r,n;c.current.devtoolsEnabled()&&(null===(r=(n=c.current).dispatchToDevtools)||void 0===r||r.call(n,e));return function(e){a.current=i.current(a.current,e),s.current.forEach((function(e){return e(a.current)}))}(e)}),[]),s=e.useRef(new Set([])),v=e.useCallback((function(e){s.current.add(e)}),[]),d=e.useCallback((function(e){s.current.delete(e)}),[]),b=e.useCallback((function(r){return function(r,n,t){var o=t.subscribe,c=t.unSubscribe,i=u(e.useState(0),2)[1],a=e.useRef(r);a.current=r;var l=e.useRef(r(n));l.current=r(n);var f=e.useCallback((function(e){a.current(e)!==l.current&&i((function(e){return e+1}))}),[]),s=e.useRef(!1),v=e.useCallback((function(){s.current=!1,c(f)}),[c,f]);return e.useEffect((function(){return s.current||o(f),s.current=!0,v}),[f,o]),l.current}(r,l(),{subscribe:v,unSubscribe:d})}),[v,d]);return e.useMemo((function(){return[b,f]}),[f,b])},E={};exports.MemoReducerProvider=function(r){var t=r.children,o=r.reducer,c=r.initialState,i=r.contextKey,a=u(w(o,c),2),l=a[0],f=a[1],s=i||"default";E[s]||(E[s]=e.createContext({}));var v=E[s],d=e.useMemo((function(){return{useSelector:l,dispatch:f}}),[l,f]);return n.default.createElement(v.Provider,{value:d},t)},exports.useMemoReducer=w,exports.useMemoReducerContext=function(r){var n=r?E[r]:E.default,t=e.useContext(n);if(!t)throw new Error("useMemoReducerContext must be used within a MemoReducerProvider");return t};
